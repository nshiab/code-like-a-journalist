---
title: Functions in TypeScript
description: Learn how to create and use functions in TypeScript.
---

# Refactoring

Coding is like a journey. You know where you start and where you want to go (in theory ðŸ˜…). But you don't which road to take. So you start exploring, you try one way, then go back, try a shortcut, get stuck dead ends and take longer roads until... you finally arrive at destination. And it's totally okay.

Same thing with your code. You'll write a lot, make mistakes, find workarounds until getting your first results. Your code will be messy and long. And it's fine.

This is why **refactoring** is usually an important step. It means restructuring your code, improving its readability, maintability and sometimes performance too, while keeping the same output.

And one key aspect of refactoring is often to break down long scripts into modular functions.

Let's take the final code of the [Savings account calculator ðŸ’¸](/saving-account-calculator). The script below calculate the gains or losses of a savings account of 10 years. If you haven't done this project, do it!

It works well but reading all of this is a bit intimidating. It could be refactored in something easier to read and understand.

Copy and paste the code below in your `main.ts`. You can also remove the `convertDollarsToEuros.ts` in `helpers` if it's still there.

```ts showLineNumbers filename="main.ts"
const initialAmount = 5000;
const interestRate = 2;
const interestRateRange = 20;
const startingYear = 2025;
const years = 10;
 
let balance = initialAmount;
 
const results = [];
 
for (let year = startingYear; year < startingYear + years; year++) {
  const randomNumber = Math.random() - 0.5;
  const randomFluctuation = randomNumber * interestRateRange;
  const randomInterestRate = Math.round(interestRate + randomFluctuation);
 
  const gainsOrLosses = Math.round(balance * (randomInterestRate / 100));
 
  balance += gainsOrLosses;
 
  results.push({
    year,
    interestRate: randomInterestRate,
    gainsOrLosses,
    balance,
  });
}
 
const lastResult = results[results.length - 1];
const finalGainsOrLosses = lastResult.balance - initialAmount;
const perc = Math.round(
  (finalGainsOrLosses / initialAmount) * 100,
);
 
if (finalGainsOrLosses > 0) {
  console.log(`
Congratulations! You've made money!
Initial amount: $${initialAmount}
Final amount: $${lastResult.balance}
Gains: $${finalGainsOrLosses} (+${perc}%)
`);
} else if (finalGainsOrLosses < 0) {
  console.log(`
Sorry! You've lost money!
Initial amount: $${initialAmount}
Final amount: $${lastResult.balance}
Losses: $${finalGainsOrLosses} (${perc}%)
`);
} else {
  console.log("\nYou've neither lost nor gained money!\n");
}
 
console.table(results);
```

For example, lines 12-14 compute a random interest rate. They could easily be encapsulated in a function. Let's create new file `randomInterestRate.ts` in the `helpers` folder with these lines in a function.

```ts showLineNumbers filename="randomInterestRate.ts"
export default function getRandomInterestRate(
  interestRate: number,
  interestRateRange: number,
) {
  const randomNumber = Math.random() - 0.5;
  const randomFluctuation = randomNumber * interestRateRange;
  const randomInterestRate = Math.round(interestRate + randomFluctuation);

  return randomInterestRate;
}
```

The lines 28-50 are also great candidates to be refactored. They log a message based on the gains or losses. Let's put them in a function named `logAnswer`. I removed the `console.table(results)` as well, we don't really need it.

```ts showLineNumbers filename="logAnswer.ts"
export default function logAnswer(
  initialAmount: number,
  results: { balance: number }[],
) {
  const lastResult = results[results.length - 1];
  const finalGainsOrLosses = lastResult.balance - initialAmount;
  const perc = Math.round(
    (finalGainsOrLosses / initialAmount) * 100,
  );

  if (finalGainsOrLosses > 0) {
    console.log(`
Congratulations! You've made money!
Initial amount: $${initialAmount}
Final amount: $${lastResult.balance}
Gains: $${finalGainsOrLosses} (+${perc}%)
`);
  } else if (finalGainsOrLosses < 0) {
    console.log(`
Sorry! You've lost money!
Initial amount: $${initialAmount}
Final amount: $${lastResult.balance}
Losses: $${finalGainsOrLosses} (${perc}%)
`);
  } else {
    console.log("\nYou've neither lost nor gained money!\n");
  }
}
```

You might be confused by the `results` type in the code above.

`{ balance: number }` describes an object with a key `balance` and an associated `number` value. And the `[]` at end means that we expect `results` to be an array of such objects.

This type description is important. In our code, we need the balance. This type makes sure it's there. If you try to pass an array of objects without a `balance` as a `number`, you'll get a type error.

To find the proper type, I just hovered over `results` in `main.ts` and copied the inferred type. No need to try to write that yourself! I removed the `year`, `interestRate` and `gainsOrLosses`, since we don't use them in the function.

![A screenshot showing VS Code displaying inferred types.](/assets/pushing-further/functions/inferred-types.png)

Now, we can update our `main.ts`. We import our new functions and use them. Our script is now simpler and easier to understand.

```ts showLineNumbers filename="logAnswer.ts" {1-2, 20, 32}
import getRandomInterestRate from "./helpers/getRandomInterestRate.ts";
import logAnswer from "./helpers/logAnswer.ts";

const initialAmount = 5000;
const interestRate = 2;
const interestRateRange = 20;
const startingYear = 2025;
const years = 10;

let balance = initialAmount;

const results = [];

for (let year = startingYear; year < startingYear + years; year++) {
  const randomInterestRate = getRandomInterestRate(
    interestRate,
    interestRateRange,
  );

  const gainsOrLosses = Math.round(balance * (randomInterestRate / 100));

  balance += gainsOrLosses;

  results.push({
    year,
    interestRate: randomInterestRate,
    gainsOrLosses,
    balance,
  });
}

logAnswer(initialAmount, results);
```

We could even go one step further by wrapping everything in `main.ts` inside a function `runSimulation`.

Let's create another file `runSimulation.ts` in `helpers` and put all of this code in it.

Since we are in `helpers` now, we need to update the import paths for `getRandomInterestRate.ts` and `logAnswer.ts`.

Also, the constant variables `initialAmount`, `interestRate`, `interestRateRange`, `startingYear` and `years` now become parameters.

```ts showLineNumbers filename="runSimulation.ts"
import getRandomInterestRate from "./getRandomInterestRate.ts";
import logAnswer from "./logAnswer.ts";

export default function runSimulation(
  initialAmount: number,
  interestRate: number,
  interestRateRange: number,
  startingYear: number,
  years: number,
) {
  let balance = initialAmount;

  const results = [];

  for (let year = startingYear; year < startingYear + years; year++) {
    const randomInterestRate = getRandomInterestRate(
      interestRate,
      interestRateRange,
    );

    const gainsOrLosses = Math.round(balance * (randomInterestRate / 100));

    balance += gainsOrLosses;

    results.push({
      year,
      interestRate: randomInterestRate,
      gainsOrLosses,
      balance,
    });
  }

  logAnswer(initialAmount, results);
}
```

Now, we can update `main.ts` and make it... incredibly simple.

```ts showLineNumbers filename="main.ts"
import runSimulation from "./helpers/runSimulation.ts";

runSimulation(5000, 2, 20, 2025, 10);
```

Our code is now very modular. While our original script could only run one simulation at the time, we can now easily run a thousand or more!

```ts showLineNumbers filename="main.ts"
import runSimulation from "./helpers/runSimulation.ts";

for (let i = 1; i <= 1000; i++) {
  console.log(`Simulation ${i}`);
  runSimulation(5000, 2, 20, 2025, 10);
}
```

![A screenshot showing VS Code displaying a thousand simulations.](/assets/pushing-further/functions/run-simulation.png)

<Callout type="info" emoji="ðŸ’¡">
    You might think that creating multiple files makes it more difficult to naviguate your code. But if you press `CMD` on Mac or `CTRL` on PC and you click on a function in your code, VS Code will automatically bring you to the function file by opening a new tab.
</Callout>

## Conclusion

Something something something.