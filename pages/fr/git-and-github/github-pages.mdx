---
title: Publier sur GitHub Pages avec Svelte
description: Dans cette leÃ§on, on apprend Ã  utiliser GitHub Pages pour hÃ©berger un site web crÃ©Ã© avec Svelte.
---

import { Callout } from "nextra/components";
import { NoticeIntro, NoticeEnd } from "../../../components/Notices.jsx";

# Publier sur GitHub Pages avec Svelte

Dans les leÃ§ons prÃ©cÃ©dentes, on a appris Ã  utiliser GitHub pour exÃ©cuter du code avec GitHub Actions. Il y a une autre fonctionnalitÃ© gÃ©niale de GitHub que je voulais vous montrer : **Pages**.

Si vous construisez votre site web sous forme de fichiers statiques Ã  partir dâ€™un dÃ©pÃ´t, GitHub peut automatiquement crÃ©er un site avec eux â€” gratuitementâ€¯! Pages est souvent utilisÃ© pour hÃ©berger la documentation de librairies, mais peut servir Ã  tout ce que vous voulez.

Dans cette leÃ§on, je vais vous montrer comment utiliser la [librairie setup-sda](https://github.com/nshiab/setup-sda) quâ€™on a utilisÃ©e dans plusieurs projets prÃ©cÃ©dents pour publier (trÃ¨s) rapidement vos projets de donnÃ©es sur GitHub.

Si ce nâ€™est pas dÃ©jÃ  fait, je vous conseille de consulter la **[leÃ§on sur Svelte](/web-basics/svelte)**, puisque câ€™est ce quâ€™on va utiliser pour construire notre site.

<NoticeIntro lang="fr" />

## Installation

CrÃ©ez un nouveau dossier et ouvrez-le dans VS Code. Ensuite, exÃ©cutez cette commande pour tout installer avec [setup-sda](https://github.com/nshiab/setup-sda) :
- `deno -A jsr:@nshiab/setup-sda --svelte --example --pages --git`

La librairie crÃ©e un dossier `sda` pour travailler avec la [librairie Simple Data Analysis](https://github.com/nshiab/simple-data-analysis), comme on lâ€™a vu dans la section [**3. La librairie SDA ğŸ¤“**](simple-data-analysis/tabular-data). Mais les options ajoutent quelques Ã©lÃ©ments :
- `--svelte` installe aussi un projet Svelte
- `--example` ajoute des donnÃ©es et du code pour montrer un exemple complet
- `--pages` ajoute un workflow GitHub (comme on lâ€™a vu dans la [leÃ§on prÃ©cÃ©dente](/git-and-github/github-actions)) et modifie quelques fichiers de configuration
- `--git` initialise le dÃ©pÃ´t et fait un premier commit une fois tous les fichiers crÃ©Ã©s.

![ExÃ©cution de setup-sda.](/assets/git-and-github/github-pages/setup.png)

Une fois la commande terminÃ©e, vous pouvez exÃ©cuter `deno task dev`, ouvrir lâ€™URL locale, et vous devriez voir un exemple de site webâ€¯! Nâ€™hÃ©sitez pas Ã  explorer le code et la page.

![Un site web d'exemple.](/assets/git-and-github/github-pages/demo.png)

## CrÃ©er un dÃ©pÃ´t

Il est maintenant temps dâ€™aller sur GitHub et de crÃ©er un nouveau dÃ©pÃ´t. Donnez-lui un nom (par exemple `my-website`), rendez-le public, et il nâ€™est pas nÃ©cessaire dâ€™ajouter un `README` ou un `.gitignore` puisque `setup-sda` sâ€™en est dÃ©jÃ  occupÃ©.

![CrÃ©ation d'un nouveau dÃ©pÃ´t.](/assets/git-and-github/github-pages/new-repo.png)

Copiez maintenant les commandes pour *push an existing repository from the command line*.

![Commandes Git.](/assets/git-and-github/github-pages/commands.png)

Puis collez-les et exÃ©cutez-les dans votre terminal.

![ExÃ©cution des commandes.](/assets/git-and-github/github-pages/run-commands.png)

Maintenant, si vous actualisez la page de votre dÃ©pÃ´t, vous verrez votre codeâ€¯!

![La page du dÃ©pÃ´t.](/assets/git-and-github/github-pages/repo-page.png)

## Activer GitHub Pages

Câ€™est le moment dâ€™activer GitHub Pages sur le dÃ©pÃ´tâ€¯!

Cliquez sur `Settings` dans votre dÃ©pÃ´t, puis sur `Pages` dans la barre latÃ©rale gauche. Ensuite, sÃ©lectionnez `GitHub Actions` comme source pour `Build and deployment`.

![Activation de GitHub Pages.](/assets/git-and-github/github-pages/enabling-pages.png)

Allez maintenant voir lâ€™onglet `Actions`. Il y a un workflow qui construit et dÃ©ploie notre site. Mais il a Ã©chouÃ© parce que GitHub Pages nâ€™Ã©tait pas activÃ© lors du premier push. Cliquez dessus.

![Ã‰chec du dÃ©ploiement sur GitHub Pages.](/assets/git-and-github/github-pages/failed.png)

Cliquez sur `Rerun jobs` et attendez quelques secondes.

![Relancer les jobs Ã©chouÃ©s.](/assets/git-and-github/github-pages/rerun.png)

Et maintenant, Ã§a fonctionneâ€¯! GitHub Actions a exÃ©cutÃ© les deux tÃ¢ches avec succÃ¨s : construire notre site, puis le publierâ€¯! Vous avez maintenant un lien vers votre site webâ€¯!

![DÃ©ploiement rÃ©ussi sur GitHub Pages.](/assets/git-and-github/github-pages/success.png)

Si vous cliquez sur le lien, vous verrez votre site en ligneâ€¯!

![Le site web.](/assets/git-and-github/github-pages/website.png)

Vous pouvez aussi retrouver le lien du site dans les paramÃ¨tres de votre dÃ©pÃ´t.

![L'URL du site.](/assets/git-and-github/github-pages/url.png)

## Mettre Ã  jour `main`

Faisons maintenant quelque chose dâ€™amusant. Mettons Ã  jour le code sur la branche `main` et poussons-le sur GitHub.

Dans `src/routes/+page.svelte`, jâ€™ai changÃ© `<h2>Climate change</h2>` en `<h2>Climate change example</h2>`. Je sais, je suis fou. ğŸ˜„

Faisons le commit et poussons les changements sur GitHub :
- `git add -A`
- `git commit -m "Update"`
- `git push`

![Faire une modification.](/assets/git-and-github/github-pages/change.png)

Si vous regardez dans lâ€™onglet `Actions`, vous verrez que le workflow est Ã  nouveau dÃ©clenchÃ© par votre push. Chaque fois que vous mettez Ã  jour la branche `main`, votre site sera reconstruit et republiÃ©â€¯! Magiqueâ€¯! ğŸ§™

PS : Jâ€™ai deux messages `Update` dans la capture parce que jâ€™ai fait une erreur. Mais vous ne devriez en avoir quâ€™un seulâ€¯!

![Le workflow est dÃ©clenchÃ©.](/assets/git-and-github/github-pages/update-action.png)

Et aprÃ¨s quelques secondes, votre site sera mis Ã  jourâ€¯!

![Mise Ã  jour du site web.](/assets/git-and-github/github-pages/update-website.png)

Avec cette configuration, vous pouvez vous concentrer sur votre code, travailler sur des branches, voir votre site en local pendant que vous dÃ©veloppez, et une fois satisfait, crÃ©er une pull request pour fusionner sur `main`.

Une fois la fusion faite, votre site sera automatiquement republiÃ©â€¯! ğŸ¤©

## Maisâ€¦ commentâ€¯?

Câ€™Ã©tait facile, nonâ€¯? ğŸ¥³ Pour que tout cela fonctionne, `setup-sda` a fait quelques ajustements pour nous.

Dans le fichier `svelte.config.js`, il a dÃ©fini un `paths.base` pour que Svelte sache que lâ€™adresse du site commencera par quelque chose comme `https://votre-nom-utilisateur.github.io/my-website/`. Cette information est transmise grÃ¢ce Ã  une variable dâ€™environnement dans le workflow GitHub.

```js showLineNumbers filename="svelte.config.js" {3, 10-12}
import adapter from "@sveltejs/adapter-static";
import { vitePreprocess } from "@sveltejs/vite-plugin-svelte";
import process from "node:process";

/** @type {import('@sveltejs/kit').Config} */
const config = {
  preprocess: vitePreprocess(),
  kit: {
    adapter: adapter(),
    paths: {
      base: process.argv.includes("dev") ? "" : process.env.BASE_PATH,
    },
  },
};

export default config;
```

La prochaine grande Ã©tape, câ€™est bien sÃ»r le workflow GitHub Actions.

Dans `.github/workflows/deploy.yml`, beaucoup de choses se passent. Si vous voulez tout comprendre en dÃ©tail, consultez la [leÃ§on sur GitHub Actions](/git-and-github/github-actions).

Mais pour rÃ©sumer, deux tÃ¢ches sont dÃ©clenchÃ©es lorsquâ€™il y a un push sur `main` :
- `build_site`, qui construit le site en passant une variable dâ€™environnement `github.event.repository.name` (utilisÃ©e dans notre `svelte.config.js`, comme vu juste au-dessus)
- `deploy`, qui publie les fichiers crÃ©Ã©s par `build_site`.


```yml showLineNumbers filename=".github/workflows/deploy.yml"
name: Deploy to GitHub Pages

on:
  push:
    branches: "main"

jobs:
  build_site:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install Deno
        uses: denoland/setup-deno@v2
        with:
          deno-version: v2.x

      - name: Install dependencies
        run: deno install

      - name: build
        env:
          BASE_PATH: "/${{ github.event.repository.name }}"
        run: deno task build

      - name: Upload Artifacts
        uses: actions/upload-pages-artifact@v3
        with:
          path: "build/"

  deploy:
    needs: build_site
    runs-on: ubuntu-latest

    permissions:
      pages: write
      id-token: write

    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}

    steps:
      - name: Deploy
        id: deployment
        uses: actions/deploy-pages@v4
```

## Conclusion

Jâ€™espÃ¨re que cette configuration vous sera utile. Jâ€™ai crÃ©Ã© `setup-sda` pour me simplifier la vie. GrÃ¢ce Ã  elle, je peux analyser des donnÃ©es avec la librairie `Simple Data Analysis` dans le dossier `sda`, puis crÃ©er des visualisations interactives dans le dossier `src` avec `Svelte`. Câ€™est le meilleur des deux mondesâ€¯!

Et avec GitHub Pages, je peux facilement partager mes dÃ©couvertes avec tout le monde. Maintenant que vous avez terminÃ© cette leÃ§on, vous le pouvez aussiâ€¯!

Faites-moi signe si vous lâ€™utilisezâ€¯! ğŸ¤—

<NoticeEnd lang="fr" />
