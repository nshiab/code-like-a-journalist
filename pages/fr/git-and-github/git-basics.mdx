---
title: Comment utiliser Git ?
description: Dans cette le√ßon, nous apprenons les bases de l'utilisation de Git.
---

import { Callout } from "nextra/components";
import { NoticeIntro, NoticeEnd } from "../../../components/Notices.jsx";

# Comment utiliser Git ?

Programmer, c‚Äôest dur. Vous avez beaucoup de code r√©parti dans nombreux fichiers, ce qui rend compliqu√© le suivi de tout ce que vous faites. Et c‚Äôest encore plus difficile si vous collaborez avec d‚Äôautres personnes‚ÄØ!

C‚Äôest pourquoi [Git](https://git-scm.com/) a √©t√© lanc√© en 2005 et est maintenant utilis√© par des millions de programmeurs √† travers le monde. C‚Äôest un **syst√®me de gestion de versions** en code ouvert. C‚Äôest le genre d‚Äôoutil qui, une fois adopt√©, vous fait vous demander comment vous avez pu travailler sans‚ÄØ!

Dans ce projet, nous allons cr√©er un programme simple pour r√©cup√©rer la temp√©rature actuelle √† Montr√©al et utiliser Git pour le versionner √† chaque √©tape.

Notez que je vais vous montrer comment utiliser Git dans le terminal. Je pense que c'est important pour comprendre comment cet outil fonctionne. Mais la prochaine le√ßon sera plus visuel gr√¢ce √† l'interface de GitHub.

<NoticeIntro lang="fr" />

## Installation

Tout d‚Äôabord, vous devez installer Git. Les √©tapes peuvent varier selon votre syst√®me d‚Äôexploitation. Suivez [les √©tapes correspondantes sur le site officiel de Git](https://git-scm.com/book/en/v2/Getting-Started-Installing-Git).

![√âtapes d‚Äôinstallation de Git.](/assets/git-and-github/git-basics/install.png)

## Initialisation

Une fois Git install√©, cr√©ez un nouveau dossier et ouvrez-le avec VS Code.

Si vous cliquez sur `Source Control` dans la barre lat√©rale gauche, vous verrez qu‚Äôil n‚Äôy a pas de d√©p√¥t Git dans ce projet.

![Message dans VS Code indiquant qu‚Äôil n‚Äôy a pas de d√©p√¥t Git.](/assets/git-and-github/git-basics/no-repo.png)

Pour initialiser un nouveau d√©p√¥t Git, ex√©cutez cette commande dans le terminal : `git init`.

Votre projet utilise maintenant Git‚ÄØ! Mais il n‚Äôy a rien dedans pour l'instant.

![Message dans VS Code indiquant qu‚Äôun d√©p√¥t Git est pr√©sent.](/assets/git-and-github/git-basics/repo-init.png)

Tout ce que vous sauvegardez avec Git sera stock√© dans un dossier cach√© `.git` dans votre projet.

![Un dossier Git cach√©.](/assets/git-and-github/git-basics/git-folder.png)

## Nouveaux fichiers

Cr√©ons un nouveau fichier `main.ts` et allons chercher les donn√©es m√©t√©o les plus r√©centes √† Montr√©al depuis l'[API du Service m√©t√©orologique du Canada](https://eccc-msc.github.io/open-data/msc-data/obs_station/readme_obs_insitu_swobdatamart_en/).

Cette API retourne les donn√©es au format XML. Nous les affichons dans le terminal.


```ts showLineNumbers filename="main.ts"
const response = await fetch(
  "https://dd.weather.gc.ca/observations/swob-ml/latest/CWTQ-AUTO-minute-swob.xml",
);
const xml = await response.text();

console.log(xml)
```

Vous pouvez maintenant voir votre nouveau fichier sous `Changes`. Sa couleur est aussi pass√©e au vert et un `U` est affich√© √† c√¥t√©, ce qui signifie `Untracked`. Vous pouvez √©galement voir un `1` dans la barre lat√©rale gauche, √† c√¥t√© du bouton `Source Control`, indiquant qu‚Äôun fichier a √©t√© modifi√©.

Git vous informe qu‚Äôil s‚Äôagit d‚Äôun nouveau fichier ‚Äî il ne l‚Äôa jamais vu auparavant et ne le suit pas encore.

![Message dans VS Code indiquant qu‚Äôun fichier n‚Äôest pas suivi.](/assets/git-and-github/git-basics/new-file.png)

Juste pour v√©rifier que le code fonctionne, vous pouvez ex√©cuter `deno -A main.ts`. Vous devriez voir les donn√©es XML affich√©es dans le terminal.

![Donn√©es XML affich√©es dans le terminal.](/assets/git-and-github/git-basics/xml-logged.png)

## Suivi et enregistrement

Git ne sauvegarde pas automatiquement votre travail. Vous devez lui indiquer quand sauvegarder votre projet. Pour enregistrer vos modifications, vous devez les **valider** (*commit*). Chaque commit poss√®de un identifiant (g√©n√©r√© par Git) et un message que vous devez fournir.

Faire un commit se fait en deux √©tapes :
- D‚Äôabord, vous suivez les fichiers (nouveaux fichiers, fichiers supprim√©s)
- Ensuite, vous validez avec un message

Faisons-le. Pour suivre tous les fichiers du projet, ex√©cutez dans votre terminal : `git add -A`

Puis validez avec cette commande, encore une fois dans votre terminal : `git commit -m "Fetching XML data"`

L‚Äôoption `-m` indique √† Git que vous fournissez un message, que vous √©crivez juste apr√®s entre guillemets.

Et voil√†‚ÄØ! Vous pouvez maintenant voir votre commit dans la section `Graph`.

![Premier commit.](/assets/git-and-github/git-basics/first-commit.png)

## Mise √† jour des fichiers

Nous avons des donn√©es XML, ce qui n‚Äôest pas tr√®s pratique. Il serait pr√©f√©rable d‚Äôavoir des donn√©es au format JSON.

Installons la librairie [`fast-xml-parser`](https://www.npmjs.com/package/fast-xml-parser) depuis NPM pour convertir nos donn√©es.

Dans votre terminal, ex√©cutez : `deno add npm:fast-xml-parser`

Puis mettez √† jour votre fichier `main.ts`.

```ts showLineNumbers filename="main.ts" {1, 6-9}
import { XMLParser } from "fast-xml-parser";

const response = await fetch(
  "https://dd.weather.gc.ca/observations/swob-ml/latest/CWTQ-AUTO-minute-swob.xml",
);
const xml = await response.text();
const json = new XMLParser({ ignoreAttributes: false }).parse(xml);

console.log(json);
```

Vous verrez maintenant d‚Äôautres changements. Comme nous avons install√© une librairie, Deno a cr√©√© les fichiers `deno.json` et `deno.lock`. Ils sont en vert et non suivis.

Mais `main.ts` est en jaune avec un `M` √† c√¥t√©. Cela signifie que Git indique que ce fichier a √©t√© modifi√©.

Vous pouvez ex√©cuter `deno -A main.ts` juste pour vous assurer que le code fonctionne.

![Des fichiers ont √©t√© modifi√©s.](/assets/git-and-github/git-basics/changes.png)

Vous pouvez v√©rifier les changements ligne par ligne dans le fichier. √Ä c√¥t√© des num√©ros de ligne, vous verrez des barres color√©es :
- Vert signifie que la ligne est nouvelle
- Bleu signifie que la ligne a √©t√© modifi√©e
- Rouge signifie que des lignes ont √©t√© supprim√©es

Si vous cliquez sur les barres, vous verrez les d√©tails. Les ajouts sont affich√©s en vert, les suppressions en rouge. Si vous souhaitez revenir √† la version pr√©c√©dente, cliquez sur la fl√®che de retour.

![Inspection des modifications dans le fichier.](/assets/git-and-github/git-basics/inspecting-changes.png)

Vous pouvez √©galement voir toutes les diff√©rences dans l‚Äôonglet `Source Control`. Cliquez sur `main.ts` pour afficher le `Working Tree`.

Par exemple, ici, on voit clairement que nous utilisons une nouvelle librairie (lignes vertes √† droite) et que nous avons supprim√© `console.log(xml)` (en rouge √† gauche).

Si vous souhaitez revenir √† une version pr√©c√©dente du fichier, vous pouvez aussi cliquer sur la fl√®che de retour sous `Changes`.

![Inspection des modifications dans le fichier via la working tree.](/assets/git-and-github/git-basics/working-tree.png)

Faisons un commit de ces changements :
- Ex√©cutez `git add -A`
- Puis `git commit -m "XML to JSON"`

Vous pouvez maintenant voir votre deuxi√®me commit dans le `Graph`. Et si vous cliquez dessus, vous pouvez voir tous les changements effectu√©s par rapport au commit pr√©c√©dent.

N‚Äôoubliez pas de faire d√©filer pour voir les modifications dans `deno.json`, `deno.lock` et `main.ts`.

![Inspection de toutes les modifications d‚Äôun commit.](/assets/git-and-github/git-basics/second-commit.png)

## Annuler un commit

L'une des fonctionnalit√©s les plus puissantes de Git est la possibilit√© de revenir facilement √† un commit pr√©c√©dent.

Par exemple, cr√©ons une erreur dans notre code. Essayons d‚Äôanalyser la r√©ponse du `fetch` comme du JSON au lieu de texte dans `main.ts`.


```ts showLineNumbers filename="main.ts" /.json()/
import { XMLParser } from "fast-xml-parser";

const response = await fetch(
  "https://dd.weather.gc.ca/observations/swob-ml/latest/CWTQ-AUTO-minute-swob.xml",
);
const xml = await response.json();
const json = new XMLParser({ ignoreAttributes: false }).parse(xml);

console.log(json);
```

Faisons un commit de cette modification avant de la tester üò± :  
- `git add -A`  
- `git commit -m "Parsing response as JSON"`

Et ensuite, testons notre nouveau code avec `deno -A main.ts`.

![Un troisi√®me commit.](/assets/git-and-github/git-basics/error.png)


Oh non‚ÄØ! √áa plante‚ÄØ! Et nous avons d√©j√† valid√©‚ÄØ! Comment revenir en arri√®re‚ÄØ?

Bien s√ªr, vous pouvez toujours v√©rifier les changements et corriger le code manuellement. Mais si vous travaillez sur un gros projet, ce n‚Äôest pas toujours r√©aliste. √Ä la place, vous pouvez utiliser la commande `git revert` avec l‚Äôidentifiant du commit.

Pour r√©cup√©rer un identifiant de commit, faites un clic droit sur le commit et cliquez sur `Copy Commit ID`. Ici, le commit que nous voulons annuler est le plus r√©cent.

![Copie de l‚ÄôID d‚Äôun commit.](/assets/git-and-github/git-basics/copy-id.png)

Commencez ensuite √† taper `git revert` dans le terminal, collez l‚Äôidentifiant du commit (n‚Äôoubliez pas l‚Äôespace entre `revert` et l‚ÄôID du commit), puis ex√©cutez la commande‚ÄØ!

Ce que vous voyez dans votre terminal est un √©diteur de texte. Les lignes au-dessus de la section `#` repr√©sentent le message de commit propos√©.

![Annulation d‚Äôun commit.](/assets/git-and-github/git-basics/revert.png)

Pour accepter le message propos√©, tapez simplement `:q` dans le terminal et appuyez sur Entr√©e pour confirmer et quitter l‚Äô√©diteur de texte du terminal. Vous pouvez aussi cliquer sur le gros bouton bleu `Commit`.

Vous verrez maintenant un quatri√®me commit, indiquant que vous avez annul√© le pr√©c√©dent‚ÄØ! Pour un *vrai* retour en arri√®re, vous pouvez aussi utiliser [`git reset`](https://git-scm.com/docs/git-reset), mais `revert` est plus s√ªr et garde une trace de tout ‚Äî y compris de l‚Äôannulation‚ÄØ!

Maintenant, si vous ex√©cutez `deno -A main.ts`, tout fonctionne comme avant notre stupide erreur.

![Un commit annul√©.](/assets/git-and-github/git-basics/reverted.png)

## Branches

Un autre concept important dans Git est celui des **branches**.

Par d√©faut, un d√©p√¥t a une branche `main`. Vous pouvez voir votre branche en bas √† gauche dans VS Code, ainsi qu‚Äô√† c√¥t√© de vos commits. Jusqu‚Äôici, nous avons travaill√© sur `main`.

![La branche main dans VS Code.](/assets/git-and-github/git-basics/main-branch.png)

En g√©n√©ral, on essaie (üòÖ) de garder `main` propre et on travaille dans des branches s√©par√©es.

Par exemple, disons que nous voulons maintenant extraire la date et la temp√©rature √† partir des donn√©es r√©cup√©r√©es pour Montr√©al. On pourrait cr√©er une nouvelle branche pour ajouter ce code au projet.

### Ajouter une branche

Pour cr√©er une nouvelle branche nomm√©e `temperature`, ex√©cutez : `git checkout -b temperature`

La commande `checkout` indique √† Git que vous voulez changer de branche. L‚Äôoption `-b` suivie de `temperature` lui dit de cr√©er une nouvelle branche `temperature` avant de s‚Äôy positionner. Comme vous √™tes sur `main`, la branche sera cr√©√©e √† partir de `main`. Le code sera exactement le m√™me sur les deux branches au d√©part.

Pour voir la liste de toutes les branches, ex√©cutez `git branch`. Celle avec un `*` devant est celle sur laquelle vous √™tes actuellement.

![La branche temperature branch dans VS Code.](/assets/git-and-github/git-basics/new-branch.png)

### Travailler dans une branche

Nous pouvons maintenant mettre √† jour notre code dans `main.ts`. Les donn√©es sont un JSON profond√©ment imbriqu√©, mais r√©cup√©rer `resultTime` et `temperature` est simple.

Si vous ex√©cutez `deno -A main.ts`, vous devriez voir la temp√©rature affich√©e dans le terminal.


```ts showLineNumbers filename="main.ts" {9-23}
import { XMLParser } from "fast-xml-parser";

const response = await fetch(
  "https://dd.weather.gc.ca/observations/swob-ml/latest/CWTQ-AUTO-minute-swob.xml",
);
const xml = await response.text();
const json = new XMLParser({ ignoreAttributes: false }).parse(xml);

const observation =
  json["om:ObservationCollection"]["om:member"]["om:Observation"];

const resultTime =
  observation["om:resultTime"]["gml:TimeInstant"]["gml:timePosition"];
console.log(resultTime);

const elements = observation["om:result"]["elements"]["element"];
type element = {
  "@_name": string;
  "@_value": string;
};
const temp = elements
  .find((d: element) => d["@_name"] === "air_temp")["@_value"];
console.log(temp);
```

Faisons un commit de cette mise √† jour :  
- `git add -A`  
- `git commit -m "Extracting temp and time"`

![Travail sur la branche temperature.](/assets/git-and-github/git-basics/commit-new-branch.png)

Ce commit a √©t√© fait sur la branche `temperature`. La branche `main`, elle, n‚Äôa pas √©t√© modifi√©e. Pour revenir √† la branche `main`, utilisez `git checkout main`.

Comme vous pouvez le constater, notre nouveau code n‚Äôest pas l√†‚ÄØ! Si jamais nous avons introduit une erreur ou un bug dans la branche `temperature`, nous savons que `main` ne l‚Äôa pas.

C‚Äôest pour cela que les branches sont si pratiques‚ÄØ: vous pouvez travailler en toute confiance dessus. Vous pouvez tester et casser des choses sans craindre de perdre vos avanc√©es. Elles sont √† l‚Äôabri‚ÄØ! Les branches sont aussi tr√®s utiles quand plusieurs personnes collaborent. Chacun peut travailler sur sa propre fonctionnalit√© dans sa propre branche.

![Passer sur la branche main.](/assets/git-and-github/git-basics/checkout-main.png)

### Fusionner des branches

Disons maintenant que nous sommes satisfaits du nouveau code dans la branche `temperature`. Nous voulons l‚Äôint√©grer √† la branche `main`.

Pour cela, nous devons **fusionner** les branches.

Assurez-vous d‚Äô√™tre sur la branche `main` (`git checkout main`), puis ex√©cutez `git merge temperature`. Cette commande va fusionner la branche `temperature` dans `main`.

Et voil√†, le nouveau code est sur `main`‚ÄØ! Et vous pouvez voir le commit que nous avons fait dans `temperature`. L‚Äôhistorique a √©t√© fusionn√©.

![Fusion avec la branche main.](/assets/git-and-github/git-basics/merge-main.png)

### Supprimer une branche

Nous n‚Äôavons plus besoin de la branche `temperature`. Supprimons-la avec la commande : `git branch -d temperature`

Comme vous pouvez le voir, la syntaxe est la m√™me que pour cr√©er une branche, sauf que l‚Äôoption est `-d` au lieu de `-b`. Faites attention‚ÄØ! üò¨

Maintenant, si vous ex√©cutez `git branch`, vous ne verrez plus `temperature`.

![Suppression de la branche temperature.](/assets/git-and-github/git-basics/delete-branch.png)

## Supprimer Git

Si, pour une raison quelconque, vous devez supprimer Git d‚Äôun projet, vous devez supprimer le dossier cach√© `.git`.

Vous pouvez le faire depuis votre explorateur de fichiers.

![Un dossier Git cach√©.](/assets/git-and-github/git-basics/git-folder.png)

Ou depuis votre terminal avec cette commande : `rm -fr .git`

Mais vous devez √™tre **extr√™mement prudent** en l‚Äôutilisant. Cette commande supprime tout de mani√®re r√©cursive. Elle pourrait effacer l‚Äôint√©gralit√© de votre ordinateur. Assurez-vous d‚Äô√™tre dans votre projet et v√©rifiez bien ce que vous tapez.

## Conclusion

F√©licitations‚ÄØ! Vous avez appris les commandes Git les plus importantes :
- `git init` pour d√©marrer un nouveau d√©p√¥t Git
- `git add -A` pour suivre les fichiers
- `git commit -m "Un message"` pour enregistrer le projet
- `git revert commitID` pour annuler un commit
- `git branch -b ma-nouvelle-branche` pour cr√©er une nouvelle branche
- `git checkout ma-nouvelle-branche` pour changer de branche
- `git merge ma-nouvelle-branche` pour fusionner des branches
- `git branch -d ma-nouvelle-branche` pour supprimer une branche

Ces huit commandes couvrent 95‚ÄØ% de vos besoins quotidiens.

Bien s√ªr, notre exemple ici √©tait assez simple. Les choses peuvent devenir plus complexes quand plusieurs personnes travaillent en m√™me temps sur diff√©rentes branches, et des conflits peuvent survenir. Mais cela devrait suffire pour bien d√©marrer votre aventure avec Git‚ÄØ!

Au fait, Git fonctionne tr√®s bien avec tous les fichiers texte, mais vous pouvez aussi suivre des images, des vid√©os, et bien plus encore‚ÄØ!

Et un dernier conseil : faites des commits fr√©quents et partez toujours du principe que vos messages sont publics. On ne sait jamais quand on devra demander de l‚Äôaide √† un coll√®gue‚ÄØ! Et si vous travaillez sur un projet en code ouvert‚Ä¶ eh bien, tout le monde verra vos commits‚ÄØ! üòÖ

Git, c‚Äôest super, mais jusqu‚Äô√† pr√©sent, tout reste sur notre ordinateur. Dans la prochaine le√ßon, nous parlerons de GitHub, qui permet de stocker votre code dans le cloud, gratuitement‚ÄØ!

<NoticeEnd lang="fr" />
